# Webhook: ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨ ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞‡¶π‡¶ø‡¶∞‡ßã üöÄ

![webhook](/public/webhook--1-.png)

‡¶Ü‡¶ú‡¶ï‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡¶•‡¶æ ‡¶¨‡¶≤‡¶¨ **Webhook** ‡¶®‡¶ø‡¶Ø‡¶º‡ßá - ‡¶è‡¶Æ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ü‡ßá‡¶ï‡¶®‡ßã‡¶≤‡¶ú‡¶ø ‡¶Ø‡¶æ ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨ ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡ßá ‡¶¨‡¶ø‡¶™‡ßç‡¶≤‡¶¨ ‡¶è‡¶®‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ø‡¶¶‡¶ø ‡¶ï‡¶ñ‡¶®‡ßã ‡¶≠‡ßá‡¶¨‡ßá ‡¶•‡¶æ‡¶ï‡ßá‡¶® ‡¶Ø‡ßá ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá Facebook ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá instant notification ‡¶™‡¶æ‡¶†‡¶æ‡¶Ø‡¶º, ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá online payment ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ real-time ‡¶è ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶è‡¶á ‡¶≤‡ßá‡¶ñ‡¶æ‡¶ü‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§

## Webhook ‡¶ï‡¶ø? ü§î

**Webhook** ‡¶π‡¶≤‡ßã ‡¶è‡¶ï‡¶ü‡¶ø **automatic notification system**‡•§ ‡¶∏‡¶π‡¶ú ‡¶ï‡¶•‡¶æ‡¶Ø‡¶º, ‡¶è‡¶ü‡¶ø ‡¶π‡¶≤‡ßã "‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶π‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶ú‡¶æ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶¶‡¶æ‡¶ì" ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ‡•§

### Real Life Example ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶¨‡ßÅ‡¶ù‡¶ø:

**Pizza Order ‡¶è‡¶∞ ‡¶Æ‡¶§:**
```
‡¶Ü‡¶™‡¶®‡¶ø pizza order ‡¶ï‡¶∞‡¶≤‡ßá‡¶® üçï
‚Üì
Restaurant ‡¶è ‡¶ï‡¶æ‡¶ú ‡¶ö‡¶≤‡¶õ‡ßá üë®‚Äçüç≥
‚Üì
Pizza ready ‡¶π‡¶≤‡ßá restaurant ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá call ‡¶ï‡¶∞‡¶¨‡ßá üìû
```

**Webhook ‡¶ì ‡¶†‡¶ø‡¶ï ‡¶è‡¶≠‡¶æ‡¶¨‡ßá‡¶á ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá:**
```
User payment ‡¶ï‡¶∞‡¶≤‡ßã üí≥
‚Üì
Stripe ‡¶è processing ‡¶ö‡¶≤‡¶õ‡ßá ‚ö°
‚Üì
Payment success ‡¶π‡¶≤‡ßá Stripe ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ server ‡¶ï‡ßá call ‡¶ï‡¶∞‡¶¨‡ßá üîî
```

## ‡¶ï‡¶ø‡¶≠‡¶æ‡¶¨‡ßá Webhook ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá? ‚öôÔ∏è

### ‡ßß. Setup Phase:
‡¶Ü‡¶™‡¶®‡¶ø service provider (‡¶Ø‡ßá‡¶Æ‡¶® Stripe) ‡¶ï‡ßá ‡¶¨‡¶≤‡ßá‡¶®:
```
"Hey Stripe, payment complete ‡¶π‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶è‡¶á endpoint ‡¶è call ‡¶ï‡¶∞‡ßã:
https://my-website.com/webhook/stripe"
```

### ‡ß®. Event Happens:
```
User ‡¶è‡¶ï‡¶ü‡¶æ payment ‡¶ï‡¶∞‡¶≤‡ßã ‚Üí Stripe ‡¶è payment process ‡¶π‡¶ö‡ßç‡¶õ‡ßá
```

### ‡ß©. Automatic Notification:
```
Payment successful ‡¶π‡¶≤‡ßá ‚Üí Stripe automatically ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ server ‡¶è POST request ‡¶™‡¶æ‡¶†‡¶æ‡¶Ø‡¶º
```

### ‡ß™. Your Server Response:
```
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ server notification receive ‡¶ï‡¶∞‡ßá ‚Üí Instant action ‡¶®‡ßá‡¶Ø‡¶º (booking create, email send, etc.)
```

## Code Example ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶¨‡ßÅ‡¶ù‡¶ø üíª

### Backend (NestJS):
```typescript
@Controller('webhook')
export class WebhookController {
  
  @Post('stripe')
  async handleStripeWebhook(@Body() data: any) {
    console.log("üîî Stripe ‡¶•‡ßá‡¶ï‡ßá notification ‡¶è‡¶∏‡ßá‡¶õ‡ßá!");
    
    if (data.type === 'payment_intent.succeeded') {
      console.log("üí∞ Payment successful!");
      
      // ‡¶è‡¶ñ‡¶® booking create ‡¶ï‡¶∞‡ßÅ‡¶®
      await this.createBooking(data.data.object);
      
      // Email notification ‡¶™‡¶æ‡¶†‡¶æ‡¶®
      await this.sendConfirmationEmail(data.data.object);
    }
    
    return { received: true };
  }
}
```

### Stripe Dashboard Setup:
```
Webhook URL: https://your-website.com/webhook/stripe
Events: payment_intent.succeeded, checkout.session.completed
```

## Webhook vs Traditional API Call üÜö

### Traditional API Call (‡¶Ü‡¶™‡¶®‡¶ø call ‡¶ï‡¶∞‡ßá‡¶®):
```
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ server ‚Üí Stripe API ‚Üí "Payment status ‡¶ï‡¶ø?"
              ‚Üê Response   ‚Üê "Still processing..."

// 5 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ server ‚Üí Stripe API ‚Üí "‡¶è‡¶ñ‡¶® status ‡¶ï‡¶ø?"
              ‚Üê Response   ‚Üê "Still processing..."

// ‡¶Ü‡¶∞‡ßã 5 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞‡ßá
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ server ‚Üí Stripe API ‚Üí "‡¶è‡¶ñ‡¶®?"
              ‚Üê Response   ‚Üê "Completed!"
```

### Webhook (‡¶§‡¶æ‡¶∞‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá call ‡¶ï‡¶∞‡ßá):
```
User payment ‡¶ï‡¶∞‡¶≤‡ßã ‚Üí Stripe processing ‚Üí Payment complete
                                      ‚Üì
                    Stripe ‚Üí ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ server ‚Üí "Payment successful!"
```

## Real-world Applications üåç

### 1. **E-commerce Payment:**
```
User checkout ‡¶ï‡¶∞‡¶≤‡ßã ‚Üí Payment gateway ‚Üí Webhook ‚Üí Order confirmation
```

### 2. **Social Media Notifications:**
```
Someone liked your post ‚Üí Platform ‚Üí Webhook ‚Üí Push notification
```

### 3. **CI/CD Pipeline:**
```
Code push ‡¶ï‡¶∞‡¶≤‡ßá‡¶® ‚Üí GitHub ‚Üí Webhook ‚Üí Automatic deployment
```

### 4. **Email Marketing:**
```
User subscribe ‡¶ï‡¶∞‡¶≤‡ßã ‚Üí Form ‚Üí Webhook ‚Üí Welcome email series
```

## ‡¶ï‡ßá‡¶® Webhook ‡¶è‡¶§ ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£? üéØ

### ‡ßß. **Instant Response (‡¶§‡¶æ‡ßé‡¶ï‡ßç‡¶∑‡¶£‡¶ø‡¶ï ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ)**
```
‚ùå Manual checking: 30 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞‡ßá ‡¶ú‡¶æ‡¶®‡¶≤‡ßá‡¶®
‚úÖ Webhook: 0.5 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶ú‡¶æ‡¶®‡¶≤‡ßá‡¶®
```

### ‡ß®. **Resource Efficient (‡¶∏‡¶Æ‡ßç‡¶™‡¶¶ ‡¶∏‡¶æ‡¶∂‡ßç‡¶∞‡¶Ø‡¶º‡ßÄ)**
```
‚ùå Polling: ‡¶¨‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶∞ API call = server load
‚úÖ Webhook: ‡¶∂‡ßÅ‡¶ß‡ßÅ event ‡¶π‡¶≤‡ßá call = minimal load
```

### ‡ß©. **Reliability (‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ)**
```
‚ùå Manual check: Miss ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡¶®‡¶æ
‚úÖ Webhook: Automatic retry mechanism
```

### ‡ß™. **Better User Experience**
```
‚ùå "Processing... please wait"
‚úÖ Instant confirmation ‡¶è‡¶¨‡¶Ç updates
```

## Common Webhook Providers üè¢

### Payment Gateways:
- **Stripe**: ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá popular, excellent webhook support
- **PayPal**: Comprehensive event system
- **Razorpay**: Indian market leader

### Development Tools:
- **GitHub**: Code push, PR merge events
- **GitLab**: CI/CD pipeline events
- **Vercel**: Deployment notifications

### Communication:
- **Twilio**: SMS/Call events
- **SendGrid**: Email delivery events
- **Slack**: Message, reaction events

## Best Practices üìã

### 1. **Security First:**
```typescript
// Webhook signature verify ‡¶ï‡¶∞‡ßÅ‡¶®
const signature = req.headers['stripe-signature'];
const event = stripe.webhooks.constructEvent(
  req.body,
  signature,
  process.env.STRIPE_WEBHOOK_SECRET
);
```

### 2. **Idempotency Handle ‡¶ï‡¶∞‡ßÅ‡¶®:**
```typescript
// Duplicate events handle ‡¶ï‡¶∞‡ßÅ‡¶®
const existingRecord = await db.findUnique({
  where: { webhookEventId: event.id }
});

if (existingRecord) {
  return; // Already processed
}
```

### 3. **Error Handling:**
```typescript
try {
  await processWebhook(event);
} catch (error) {
  console.error('Webhook processing failed:', error);
  // Log for debugging
  // Return appropriate status code
}
```

### 4. **Timeout Management:**
```typescript
// ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ response ‡¶¶‡¶ø‡¶®
app.post('/webhook', async (req, res) => {
  res.status(200).json({ received: true });
  
  // Background ‡¶è process ‡¶ï‡¶∞‡ßÅ‡¶®
  processWebhookAsync(req.body);
});
```

## Development ‡¶è Webhook Test ‡¶ï‡¶∞‡¶æ üß™

### Local Development:
```bash
# Stripe CLI ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá
stripe listen --forward-to localhost:3001/webhook/stripe

# ‡¶Ö‡¶•‡¶¨‡¶æ ngrok ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá
ngrok http 3001
```

### Testing Tools:
- **Stripe CLI**: Built-in testing
- **Webhook.site**: Generic webhook testing
- **Postman**: Custom webhook simulation

## Common Pitfalls ‡¶è‡¶¨‡¶Ç Solutions üö®

### 1. **Webhook Timeout:**
```
‚ùå Long processing in webhook handler
‚úÖ Quick acknowledgment + background processing
```

### 2. **Missing Security:**
```
‚ùå Raw body processing without verification
‚úÖ Signature verification ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá authenticity check
```

### 3. **No Retry Logic:**
```
‚ùå One-time failure = permanent failure
‚úÖ Implement retry mechanism
```

### 4. **Duplicate Processing:**
```
‚ùå Same event multiple times processing
‚úÖ Idempotency key ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá duplicate prevention
```

## ‡¶è‡¶ï‡¶ü‡¶ø Complete Example: Trip Booking System üé´

### Frontend:
```typescript
const handleBooking = async () => {
  const response = await fetch('/api/create-checkout', {
    method: 'POST',
    body: JSON.stringify({ tripId, userId, amount })
  });
  
  const { checkoutUrl } = await response.json();
  window.location.href = checkoutUrl;
};
```

### Backend Webhook:
```typescript
@Post('webhook/stripe')
async handleStripeWebhook(@Body() event: any) {
  if (event.type === 'checkout.session.completed') {
    const session = event.data.object;
    
    // Database transaction
    await this.prisma.$transaction(async (tx) => {
      // Payment record
      const payment = await tx.payment.create({
        data: {
          stripeSessionId: session.id,
          amount: session.amount_total / 100,
          status: 'completed'
        }
      });
      
      // Booking record
      await tx.booking.create({
        data: {
          userId: session.metadata.userId,
          tripId: session.metadata.tripId,
          paymentId: payment.id,
          status: 'confirmed'
        }
      });
    });
    
    // Send confirmation email
    await this.emailService.sendBookingConfirmation(session);
  }
}
```

## Future of Webhooks üîÆ

### Trends:
- **GraphQL Subscriptions**: Real-time data updates
- **WebSocket Integration**: Bi-directional communication
- **Event-Driven Architecture**: Microservices communication
- **Serverless Functions**: Webhook handlers as functions

### Emerging Standards:
- **CloudEvents**: Standardized event format
- **AsyncAPI**: Documentation for event-driven APIs
- **Webhook Security**: Enhanced authentication methods

## ‡¶∂‡ßá‡¶∑ ‡¶ï‡¶•‡¶æ üéØ

Webhook ‡¶Ü‡¶ß‡ßÅ‡¶®‡¶ø‡¶ï ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨ ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ö‡¶™‡¶∞‡¶ø‡¶π‡¶æ‡¶∞‡ßç‡¶Ø ‡¶Ö‡¶Ç‡¶∂‡•§ ‡¶è‡¶ü‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ application ‡¶ï‡ßá ‡¶Ü‡¶∞‡ßã responsive, efficient ‡¶è‡¶¨‡¶Ç user-friendly ‡¶ï‡¶∞‡ßá ‡¶§‡ßã‡¶≤‡ßá‡•§ 

‡¶è‡¶ï‡¶ú‡¶® developer ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá webhook ‡¶è‡¶∞ proper implementation ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ application ‡¶è‡¶∞ quality ‡¶è‡¶¨‡¶Ç user experience significantly improve ‡¶ï‡¶∞‡¶¨‡ßá‡•§

### Key Takeaways:
‚úÖ Webhook = Automatic notification system  
‚úÖ Real-time communication enable ‡¶ï‡¶∞‡ßá  
‚úÖ Server resources save ‡¶ï‡¶∞‡ßá  
‚úÖ Better user experience ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡ßá  
‚úÖ Modern applications ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø essential  

